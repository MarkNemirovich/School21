## Протокол **DHCP**
**DHCP** — протокол прикладного уровня модели TCP/IP, служит для назначения IP-адреса клиенту.
IP-адрес можно назначать вручную каждому клиенту, то есть компьютеру в локальной сети.
Но в больших сетях это очень трудозатратно, к тому же, чем больше локальная сеть, тем выше возрастает вероятность ошибки при настройке.
Поэтому для автоматизации назначения IP был создан протокол **DHCP**.

Получение адреса проходит в четыре шага.
Этот процесс называют *DORA* по первым буквам каждого шага:
- Discovery (Обнаружение),
- Offer (Предложение),
- Request (Запрос),
- Acknowledgement (Подтверждение).

#### Опции **DHCP**
Для работы в сети клиенту требуется не только IP, но и другие параметры **DHCP**: например, маска подсети, шлюз по умолчанию и адрес сервера. Опции представляют собой пронумерованные пункты, строки данных, которые содержат необходимые клиенту сервера параметры конфигурации.

Дадим описания некоторым опциям:
- Option 1 — маска подсети IP; 
- Option 3 — основной шлюз; 
- Option 6 — адрес сервера DNS (основной и резервный); 
- Option 51 — определяет, на какой срок IP-адрес предоставляется в аренду клиенту; 
- Option 55 — список запрашиваемых опций. Клиент всегда запрашивает опции для правильной конфигурации. Отправляя сообщение с Option 55, клиент выставляет список запрашиваемых числовых кодов опций в порядке предпочтения. **DHCP**-сервер старается отправить ответ с опциями в том же порядке. 

#### Принудительное обновление IP-адреса клиентом DHCP (dhclient)

Для принудительного обновления IP-адреса клиенту необходимо использовать протокол динамической настройки узла при помощи команды dhclient. Обычно клиент сам не прекращает аренду адреса, так как это протокол DHCP этого не требует. Однако некоторые интернет-провайдеры могут требовать от своих клиентов уведомлять сервер, когда они хотят освободить назначенный IP-адрес. Команда dhclient позволяет настроить один или несколько сетевых интерфейсов с помощью протокола динамической настройки узла или протокола BOOTP. Если же эти протоколы не работают, то адрес назначается статически. 

Рассмотрим команду для принудительного освобождения IP-адреса DHCP-клиента в Linux.

*Предупреждение: Освобождение IP-адреса всегда приводит к сбою сетевого интерфейса/WiFi, поэтому будь осторожен при использовании на удаленных системах.*

Флаг *-r* явно освобождает адрес и после этого клиент завершает работу. Например, откроем терминал и введем команду:
```shell
$ sudo dhclient -r
```

Затем с помощью **DHCP** в Linux получим свежий IP-адрес:
```shell
$ sudo dhclient
```

Чтобы обновить или освободить IP-адрес для конкретного интерфейса, например, eth0, можно ввести:
```shell
$ sudo dhclient -r eth0
$ sudo dhclient eth0
```

