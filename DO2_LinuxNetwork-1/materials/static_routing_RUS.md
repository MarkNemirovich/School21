## Как эмулировать сеть при помощи VirtualBox

#### Создание базовых виртуальных машин

Чтобы сделать топологию сети, сначала нужно создать новую виртуальную машину, например Ubuntu Server 20.04 LTS.

Клонирование виртуальной машины — это самый простой способ создания дополнительных гостевых виртуальных машин на хост-компьютере.

Чтобы сделать ПК и маршрутизаторы для эмуляции сети, клонируй виртуальную машину сервера Ubuntu, созданную в предыдущем шаге. Щелкни правой кнопкой мыши на сервере Ubuntu и выбери в меню пункт Clone.

В диалоговом окне введи новое имя ВМ и не забудь повторно инициализировать MAC-адреса всех сетевых карт. Ты должен убедиться, что MAC-адреса отличаются на каждой клонированной ВМ.

В следующем диалоговом окне выбери Linked Clone, чтобы оставить размер файла клонированной ВМ небольшим.

Нажми кнопку Clone, и новая ВМ появится в окне VirtualBox Manager.

Повтори эти действия для каждой требуемой ВМ.
Выбери имена виртуальных машин, чтобы они соответствовали именам узлов, которые тебе нужны.

На каждой ВМ необходимо настроить сетевые интерфейсы и подключить их к внутренним сетям VirtualBox, чтобы создать сетевую топологию.

#### Создание внутренних сетей VirtualBox

Графический интерфейс VirtualBox поддерживает только четыре сетевых адаптера для каждой ВМ. Из-за этого ограничивается сложность возможных сетевых сценариев.

Каждый сетевой адаптер можно включить или выключить. Если адаптер включен, он может быть настроен на подключение к одному из множества различных типов интерфейсов, предоставляемых VirtualBox.

Чтобы соединить две виртуальные машины друг с другом, используй тип интерфейса Internal Network.

Выбери одну из виртуальных машин в окне VirtualBox Manager и нажми на Settings (Настройки). Затем в окне настроек щелкни на Network (Сеть).

Установи флажок Enable Network Adapter, если он еще не установлен. Затем щелкни Attached To и выбери Internal Network.

Далее задай имя внутренней сети. Имя должно совпадать с именем сети, настроенной на соответствующем сетевом адаптере на другой ВМ, которая будет соединена с этой ВМ.

Повтори для каждого узла.

Маршрутизаторы используют три из четырех доступных сетевых адаптеров для подключения к внутренним сетям. ПК используют по одному сетевому адаптеру.

## Как добавить статические маршруты в Ubuntu Linux

Добавление статических маршрутов в Linux может быть выполнено с помощью следующей команды:
`ip r add [адрес подключения] dev [имя сети]`

Однако соединение, созданное данной командой, исчезнет после перезагрузки сети или системы.

Чтобы сделать статические маршруты постоянными в Ubuntu Linux, нужно добавить записи маршрутов в файл сетевого интерфейса с помощью свойства routes.

Обрати внимание, что тебе необходимо перезагрузить конфигурацию **netplan** с помощью команды `netplan apply`, когда ты добавляешь новую запись маршрута в YAML-файл.

